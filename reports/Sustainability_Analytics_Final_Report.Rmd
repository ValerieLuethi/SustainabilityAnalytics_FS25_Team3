---
title: "Sustainability Analytics: Project Report Group 2"
subtitle: "Effect of Climate Change on Aletschgletscher and the village of Brig"
author:
  - name: "Vani Gupta"
    affiliation: "Hochschule Luzern"
    email: "vani.gupta@stud.hslu.ch"
  - name: "Ramona Kölliker"
    affiliation: "Hochschule Luzern"
    email: "ramona.kölliker@stud.hslu.ch"
  - name: "Valérie Lüthi"
    affiliation: "Hochschule Luzern"
    email: "valerie.lüthi@stud.hslu.ch"
  - name: "Alois Wagner"
    affiliation: "Hochschule Luzern"
    email: "alois.wagner@stud.hslu.ch"
date: "2025-09-05"
output:
  html_document:
    number_sections: true
    theme: lumen
    code_folding: hide
    toc: true
    toc_float: true
    toc_collapsed: true
    toc_depth: 3
    toc-title: Table of Content
  minidown::mini_document:
    result_folding: show
---

<u>**Loading R-Packages**</u>

```{r Loading_Packages, include=TRUE, warning=FALSE, message=FALSE, echo=TRUE, results='hide'}
#Loading needed packages
library(readr)
library(dplyr)
library(lubridate)
library(tseries)
library(zoo)
library(forecast)
```

<br><p style="font-size: 35px;"> Introduction </p><br>

This report presents the course project developed during the blockweek Sustainability Analytics FS25.

# Data

The data from the Jungfraujoch weather station was obtained through the open data service of the Federal Office of Meteorology and Climatology [MeteoSwiss](https://www.meteoswiss.admin.ch/services-and-publications/service/open-data.html). The Jungfraujoch weather station is located 3'571 meters above sea level with measurements available from 01/01/1933 to 01/07/2025. We were interested in the homogeneous monthly mean of the air temperature (C°) measured 2 meters above ground.

<u>**Loading Jungfraujoch Temperature Data**</u>

```{r loading_dataset_jungfraujoch_temperature, include=TRUE, warning=FALSE, message=FALSE, echo=TRUE, results='hide'}
# Reading in datasets
#df_data <- read.csv("xxxxx.csv")

# load Jungfraujoch data
df_jungfraujoch <- read.delim("../data/raw/weather_monthly_jungfraujoch.csv", header=TRUE, sep = ";")
head(df_jungfraujoch)
str(df_jungfraujoch)
```

# Data Preparation

## Jungfraujoch Temperature Data

<u>**Datapreparation of Jungfraujoch_Temperature_dataset**</u>
```{r jungfraujoch_temperature_datapreparation, include=TRUE, warning=FALSE, message=FALSE, echo=TRUE, results='hide'}
# convert timestamp to datetime
df_jungfraujoch <- df_jungfraujoch %>%
  mutate(reference_timestamp = dmy_hm(reference_timestamp))
str(df_jungfraujoch)
# only keep the columns needed for further analysis
df_jungfraujoch_reduced <- df_jungfraujoch %>% 
  select(station_abbr, reference_timestamp, ths200m0)
# rename the columns
colnames(df_jungfraujoch_reduced) <- c('station_abbr', 'reference_timestamp', 'temp_mean_C')
# check for NAs
colSums(is.na(df_jungfraujoch_reduced)) # no NAs
# create a timeseries object
ts_jungfraujoch <- ts(df_jungfraujoch_reduced$temp_mean_C,
                      start = c(1933, 1),
                      end = c(1933 + (nrow(df_jungfraujoch_reduced)-1) %/% 12,
                              (nrow(df_jungfraujoch_reduced)-1) %% 12 + 1),
                      frequency = 12)
str(ts_jungfraujoch)
```

<u>**Datapreparation of Brig_Rain dataset**</u>
```{r rain_brig_datapreparation, include=TRUE, warning=FALSE, message=FALSE, echo=TRUE, results='hide'}
#code
```


# Data Analysis

## Jungfraujoch Temperature
<u>**Data Analysis Jungfraujoch_Temperature dataset**</u>
```{r jungfraujoch_temperature_dataanalysis, include=TRUE, warning=FALSE, message=FALSE, echo=TRUE, results='hide'}
# summary statistics
summary(ts_jungfraujoch)
# plot
plot(ts_jungfraujoch, main="Jungfraujoch Monthly Temperature", ylab="°C")
# check acf and pacf
# acf and pacf
acf(ts_jungfraujoch) # acf indicates seasonality
pacf(ts_jungfraujoch) # damped sinusoid
```
<u>**Decomposition Jungfraujoch_Temperature dataset**</u>
```{r jungfraujoch_temperature_decompose, include=TRUE, warning=FALSE, message=FALSE, echo=TRUE, results='hide'}
# decomposition
ts_jungfraujoch_comp = decompose(ts_jungfraujoch)
plot(ts_jungfraujoch_comp)
# check stationarity with adf
adf.test(ts_jungfraujoch, alternative = "stationary") # p = .01 indicates stationarity
# save components
ts_jungfraujoch_trend <- ts_jungfraujoch_comp$trend
ts_jungfraujoch_seasonal <- ts_jungfraujoch_comp$seasonal
ts_jungfraujoch_remainder <- ts_jungfraujoch_comp$random
# plot trend
plot(ts_jungfraujoch_trend, main="Trend Jungfraujoch")
# plot seasonality
plot(ts_jungfraujoch_seasonal, main="Seasonal Jungfraujoch")
# plot remainder
plot(ts_jungfraujoch_remainder, main="Remainder Jungfraujoch")
# acf and pacf of residuals
residuals_clean_jungfrau <- na.omit(ts_jungfraujoch_remainder)
acf(residuals_clean_jungfrau) # fast decay
pacf(residuals_clean_jungfrau) # strong negative lags - mean reverting behavior?, cyclicity
```
<u>**STL Decomposition Jungfraujoch_Temperature dataset**</u>
```{r jungfraujoch_temperature_decompose_STL, include=TRUE, warning=FALSE, message=FALSE, echo=TRUE, results='hide'}
# decomposition with stl
ts_jungfraujoch_stl <- stl(ts_jungfraujoch, s.window = "periodic") # assumes strong, stable seasonality
plot(ts_jungfraujoch_stl, main = "s.window periodic")
ts_jungfraujoch_stl_13 <- stl(ts_jungfraujoch, s.window = 13) # 1 year smooth
plot(ts_jungfraujoch_stl_13, main = "s.window = 13")
ts_jungfraujoch_stl_25 <- stl(ts_jungfraujoch, s.window = 25) # 2 year smooth
plot(ts_jungfraujoch_stl_25, main = "s.window = 25")
ts_jungfraujoch_stl_37 <- stl(ts_jungfraujoch, s.window = 37) # 3 year smooth
plot(ts_jungfraujoch_stl_37, main = "s.window = 37")
ts_jungfraujoch_stl_37_121 <- stl(ts_jungfraujoch, s.window = 37, t.window=121) # 3 year smooth
plot(ts_jungfraujoch_stl_37_121, main = "s.window = 37, t.window=121")
ts_jungfraujoch_stl_49 <- stl(ts_jungfraujoch, s.window = 49)
plot(ts_jungfraujoch_stl_49)

remainder_periodic <- ts_jungfraujoch_stl$time.series[, "remainder"]
acf(remainder_periodic, main = "ACF of STL remainder, periodic")
pacf(remainder_periodic, main = "PACF of STL remainder, periodic")

remainder_13 <- ts_jungfraujoch_stl_13$time.series[, "remainder"]
acf(remainder_13, main = "ACF of STL remainder, s.window = 13")
pacf(remainder_13, main = "PACF of STL remainder, s.window = 13")

remainder_25 <- ts_jungfraujoch_stl_25$time.series[, "remainder"]
acf(remainder_25, main="ACF of STL remainder, s.window = 25")
pacf(remainder_25, main = "PACF of STL remainder, s.window = 25")

remainder_37 <- ts_jungfraujoch_stl_37$time.series[, "remainder"]
acf(remainder_37, main = "ACF of STL remainder, s.window = 37") # ACF lags 2 and 5 persist
pacf(remainder_37, main = "PACF of STL remainder, s.window = 37")

remainder_37_121 <- ts_jungfraujoch_stl_37_121$time.series[, "remainder"]
acf(remainder_37_121)
pacf(remainder_37_121) # no change compared to without t.window, lags 9,12 and 22 are negative, maybe some seasonality left?

remainder_49 <- ts_jungfraujoch_stl_49$time.series[, "remainder"]
acf(remainder_49, main="ACF of STL remainder, s.window=49") # no change compared to 37 window
pacf(remainder_49, main="PACF of STL remainder, s.window=49")
```
<u>**Create Jungfraujoch_Temperature datasframe*</u>
```{r jungfraujoch_temperature_dataframe, include=TRUE, warning=FALSE, message=FALSE, echo=TRUE, results='hide'}
# Extract components
components <- ts_jungfraujoch_stl_37_121$time.series

# Create a time index (Date or Year-Month depending on your ts object)
dates <- time(ts_jungfraujoch)

# Build a data frame
df_jungfraujoch_processed <- data.frame(
  date       = dates,
  observed   = as.numeric(ts_jungfraujoch),
  trend      = as.numeric(components[, "trend"]),
  seasonal   = as.numeric(components[, "seasonal"]),
  remainder  = as.numeric(components[, "remainder"])
)

head(df_jungfraujoch_processed)
str(df_jungfraujoch_processed)

# create processed data file
write.csv(df_jungfraujoch_processed, "../data/processed/jungfraujoch_temperature.csv", row.names = FALSE)
# RDS
saveRDS(df_jungfraujoch_processed, "../data/processed/jungfraujoch_temperature.rds")
```
### H3 {#chapter-with-features}

<u>**----->"Header for the Code Block1<------**</u>
```{r first_subset_feature_exp, include=TRUE, warning=FALSE, message=FALSE, echo=TRUE}
#code
```
<u>**----->"Header for the Code Block1<------**</u>
```{r first_subset_feature_exp1, include=TRUE, warning=FALSE, message=FALSE, echo=TRUE}
#code
```

The [feature explanation](#Table_feature_exp) can be found in the appendix.






# Appendix

## Feature Explanation of the dataset {#Table_feature_exp}

This section provides further explanations for the dataset.

```{r data_dict, include=TRUE, warning=FALSE, message=FALSE, echo=TRUE}

```

[Back to Chapter 'H3'](#chapter-with-features)
